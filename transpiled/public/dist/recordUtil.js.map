{"version":3,"sources":["../../../public/dist/recordUtil.js"],"names":["ERR_MSG_DUPLICATE_VAL","ERR_MSG_EACH_VAL_SAME","ERR_MSG_NO_CONTENTS","TIME_POPOVER_CONFIG","trigger","placement","content","html","container","offset","createAssEveRow","customClass","dataOrder","title","$","createHtmlAs1Eve","random","Math","toString","slice","setEveInputValues","inputs","value","eq","attr","format0to00","createOneEveRow","doc","masterJson","saveBtn","console","log","block","find","css","colors","popover","hover","e","onHoverForPopover","on","parents","jsonC","JSON","parse","tr","index","popoverId","e2","target","hide","show","dataNum","stringify","window","length","hasClass","off","setDataOrderToEveList","setDatePickerLisntener","event","date","time","moment","val","hour","minute","sortByTime","format","sortByMixitUp","ev","splice","tooltip","remove","each","i","elem","ym","parseInt","input","isValid","key","hasOwnProperty","errSpan","parent","addClass","toggleBtn","removeClass","keyup","isValidAboutNullAndDelimiter","currentDataOrder","insertBefore","hourOfDay","min","ele","bootstrapMaterialDatePicker","shortTime","isModalOpen","createOneRangeRow","count","blocks","setDataOrderToRangeList","craeteHtmlAs1Row","label0","setLabelOfOffset","level2","startInputs","endInputs","setRangeDatePicker","closest","getRangeIndex","prev","next","checkRangeDuplicateItem","startInput","endInput","errSpanStart","errSpanEnd","showEachErrSpan","colorNum","newColor","trs","className","initAllTooltips","dataOrderRow","floor","label","rangeNum","errMsg","createHtmlAs2","rowOrder","startOrEnd","otherEdge","otherClass","n","add","timeOther","max","timeInput","timeOtherInput","datePickers","radios","createHtmlRadio","row","setElementAsMdl","radioCount","id0","id1","id2","getCommentAsNullable","childSnap","operateAs4","clone","createHtmlAs4","summery","indexOf","DELIMITER","ERR_MSG_CONTAIN_BAD_CHAR","join","append","createAddTagBtn","setTagUi","splited","highlightColors","showModal","modal","onClickAddParamsLiBtn","push","ul","createParamsLi","appendTo","createAddLiBtn","onKeyUpParamsTitle","split","createNewTimeEveData","today","year","month","createNewRangeData","createNewData","dataType","data","day","mon","dataName","jsonStr","eventList","rangeList","map","forEach","cal","hm","sortedKeys","Object","keys","sort","a","b","newEveList","isShow","fadeIn","fadeOut","onClickAddRowBtn","newRow","mixitup","load","behavior","liveSort","animation","duration","nudge","reverseOut","effects","selectors","control","initAddLiBtn","addLiBtn","poppover","getDefaultTemplate"],"mappings":"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","file":"recordUtil.js","sourcesContent":["const ERR_MSG_DUPLICATE_VAL = \"項目名が重複しています\";\r\nconst ERR_MSG_EACH_VAL_SAME = \"項目名は開始と終了で別にしてください\";\r\nconst ERR_MSG_NO_CONTENTS = '項目は最低でもひとつ必要です';\r\n\r\nconst TIME_POPOVER_CONFIG = {\r\n    trigger: 'manual',\r\n    placement: 'bottom',\r\n    content:'<div class=\"circle-popover\">'+\r\n    '<span class=\"fa-layers modal-circle-w modal-circle-w1\">'+\r\n    '<i class=\"fas fa-circle modal-circle-i circle1\"></i>'+\r\n    '<i class=\"fas fa-check modal-circle-check\" data-fa-transform=\"shrink-8\"></i>'+\r\n    '</span>'+\r\n    '<span class=\"fa-layers modal-circle-w\">'+\r\n    '<i class=\"fas fa-circle modal-circle-i circle2\"></i>'+\r\n    '<i class=\"fas fa-check modal-circle-check\" data-fa-transform=\"shrink-8\"></i>'+\r\n    '</span>'+\r\n    '<span class=\"fa-layers modal-circle-w\">'+\r\n    '<i class=\"fas fa-circle modal-circle-i circle3\"></i>'+\r\n    '<i class=\"fas fa-check modal-circle-check\" data-fa-transform=\"shrink-8\"></i>'+\r\n    '</span>'+\r\n    '<span class=\"fa-layers modal-circle-w\">'+\r\n    '<i class=\"fas fa-circle modal-circle-i circle4\"></i>'+\r\n    '<i class=\"fas fa-check modal-circle-check\" data-fa-transform=\"shrink-8\"></i>'+\r\n    '</span>'+\r\n    '</div>',\r\n    html: true,\r\n    container: 'body',\r\n    offset: '0, 15px'\r\n};\r\n\r\nfunction createAssEveRow(customClass, dataOrder) {\r\n    var title = null;\r\n    switch (customClass){\r\n        case 'eve-add':\r\n            title = '項目を追加（時刻）';\r\n            break;\r\n        case 'range-add':\r\n            title = '項目を追加（範囲）';\r\n            break;\r\n    }\r\n    return $(\r\n        '<tr class=\"add-eve-row '+ customClass +'\" data-order=\"'+ dataOrder +'\">'+\r\n            '<td colspan=\"4\">'+\r\n                '<button class=\"mdl-button mdl-js-button mdl-button--icon mdl-pre-upgrade\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"'+title+'\">' +\r\n                    '<i class=\"material-icons\">add_circle</i>' +\r\n                '</button>'+\r\n            '</tr>'+\r\n        '</td>');\r\n}\r\n\r\nfunction createHtmlAs1Eve() {\r\n    var random = Math.random().toString(36).slice(-8);\r\n    return $(\r\n        '<tr>'+\r\n            '<td class=\"circle_wrapper\">' +\r\n                '<div class=\"circle\"></div>' +\r\n            '</td>' +\r\n\r\n            '<td>' +\r\n                '<form action=\"#\" class=\"time colored\">' +\r\n                    '<div class=\"mdl-textfield mdl-js-textfield mdl-pre-upgrade mdl-textfield--floating-label\">' +\r\n                        '<input class=\"mdl-textfield__input time_input mdl-pre-upgrade\" type=\"text\" id=\"sample\">' +\r\n                        '<label class=\"mdl-textfield__label mdl-pre-upgrade\" for=\"sample\"></label>' +\r\n                        '<span class=\"mdl-textfield__error mdl-pre-upgrade\"></span>'+\r\n                    '</div>' +\r\n                '</form>' +\r\n            '</td>' +\r\n\r\n            '<td>' +\r\n                '<form action=\"#\" class=\"event_name\">' +\r\n                    '<div class=\"mdl-textfield mdl-js-textfield mdl-pre-upgrade\">' +\r\n                        '<input class=\"mdl-textfield__input input_eve mdl-pre-upgrade\" type=\"text\" id=\"'+ random +'\">' +\r\n                        '<label class=\"mdl-textfield__label mdl-pre-upgrade\" for=\"'+ random +'\"></label>'+\r\n                        '<span class=\"mdl-textfield__error mdl-pre-upgrade\"></span>' +\r\n                    '</div>' +\r\n                '</form>' +\r\n            '</td>'+\r\n\r\n            '<td>'+\r\n                '<button class=\"mdl-button mdl-js-button mdl-button--icon mdl-pre-upgrade remove-btn\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"項目を削除\">' +\r\n                    '<i class=\"fas fa-times\"></i>' +\r\n                '</button>' +\r\n            '</td>'+\r\n        '</tr>'\r\n    )[0];\r\n}\r\n\r\nfunction setEveInputValues(inputs, value) {\r\n    inputs.eq(0).attr(\"value\", value[\"cal\"][\"hourOfDay\"] + \":\" + format0to00(value[\"cal\"][\"minute\"]));\r\n    inputs.eq(1).attr(\"value\", value[\"name\"]);\r\n}\r\n\r\nfunction createOneEveRow(doc, value, masterJson, saveBtn) {\r\n    console.log(value);\r\n\r\n    var block = $(createHtmlAs1Eve());\r\n    var inputs = block.find(\".mdl-textfield__input\");\r\n    setEveInputValues(inputs, value);\r\n\r\n    block.find('.circle').css('background-color', colors[value[\"colorNum\"]])\r\n        .popover(TIME_POPOVER_CONFIG)\r\n        .hover(function (e) {\r\n            onHoverForPopover(e);\r\n        })\r\n        .on('shown.bs.popover', function (e) {\r\n            console.log('onShown');\r\n            var dataOrder = $(this).parents(\".card-wrapper-i\").attr('data-order');\r\n            var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n            var tr = $(this).parents('tr');\r\n            var index = tr.index();\r\n\r\n            var popoverId = $(this).attr('aria-describedby');\r\n            var popover = $('#'+popoverId);\r\n            popover.find('.fa-layers')\r\n                .on('click', function (e2) {\r\n                    console.log('cicle clicked');\r\n\r\n                    var index = $(e2.target).parents('.fa-layers').index();\r\n                    console.log(index);\r\n                    $(e.target).css('background-color', colors[index]);\r\n                    $(e2.target).parents('.circle-popover').find('.fa-check:visible').hide();\r\n                    $(e2.target).parents('.fa-layers').find('.fa-check').show();\r\n\r\n                    var dataOrder = $(e.target).parents(\".card-wrapper-i\").attr('data-order');\r\n                    var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n                    var dataNum = $(e.target).parents('tr').index();\r\n                    jsonC[\"eventList\"][dataNum]['colorNum'] = index.toString();\r\n                    masterJson[dataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n                })\r\n                .eq(jsonC[\"eventList\"][index]['colorNum'])\r\n                .find('.fa-check').show();\r\n\r\n            $(window).hover(function (e2) {\r\n                var dataOrder = $(e.target).parents(\".card-wrapper-i\").attr('data-order');\r\n                //混迷を極めるhover判定\r\n                if($(e2.target).parents('.popover').length || $(e2.target).hasClass('popover')) {\r\n                    return false;\r\n                } else if(($(e2.target).hasClass('card') || $(e2.target).parents('tr').index() === index || $(e2.target).parents('tr').index() === index+1)\r\n                    &&\r\n                    ($(e2.target).parents('.card-wrapper-i[data-order='+ dataOrder +']').length || $(e2.target).attr('data-order') == dataOrder)) {\r\n                    return false\r\n                }\r\n                console.log('hideやね', e2.target);\r\n                $(e.target).popover('hide');\r\n            });\r\n\r\n        }).on('hidden.bs.popover', function (e) {\r\n        console.log('onHidden');\r\n        $(window).off('mouseenter mouseleave');\r\n    });\r\n\r\n    setDataOrderToEveList(block, value['cal']['hourOfDay'], value['cal']['minute']);\r\n\r\n    setDatePickerLisntener($(block).find('.time .mdl-textfield__input'))\r\n        .on('change', function (event, date) {\r\n            console.log(event, date);\r\n            var tr = $(event.target).parents('tr');\r\n            var index = tr.index();\r\n            var dataOrder = $(event.target).parents(\".card-wrapper-i\").attr('data-order');\r\n            var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n            var time = moment($(event.target).val(), 'H:mm');\r\n            jsonC[\"eventList\"][index][\"cal\"][\"hourOfDay\"] = time.hour();\r\n            jsonC[\"eventList\"][index][\"cal\"][\"minute\"] = time.minute();\r\n            jsonC['eventList'] = sortByTime(jsonC['eventList']);\r\n            masterJson[dataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n\r\n            tr.attr('data-order', time.format('Hmm'));\r\n            console.log(masterJson);\r\n\r\n            sortByMixitUp($(doc));\r\n        });\r\n\r\n    //項目削除イベント\r\n    block.find('.remove-btn').on('click', function (ev) {\r\n        console.log('項目削除');\r\n        var dataOrder = $(this).parents(\".card-wrapper-i\").attr('data-order');\r\n        var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n        var index = $(this).parents('tr').index();\r\n        jsonC[\"eventList\"].splice(index, 1);\r\n        masterJson[dataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n        $(this).tooltip('hide');\r\n        $(this).parents('tr').remove();\r\n\r\n        $(doc).find('table').find('tr').each(function (i, elem) {\r\n            var ym = $(elem).attr('data-order');\r\n            console.log(i, ym);\r\n            if (ym && parseInt(ym) < 10000) {//range-preのdataOrderは10000\r\n\r\n                var index = $(elem).index();\r\n                var input = $(elem).find('.input_eve');//todo ここでさ、index使ってるじゃん。てことはさ、配列も並び替えしなきゃいけないんだよ、きっと。\r\n                console.log('index:', index);\r\n                var jsonC = JSON.parse(masterJson[dataOrder]['data']['0']);\r\n                var isValid = true;\r\n                for(var key in jsonC['eventList']) {\r\n                    if(!jsonC['eventList'].hasOwnProperty(key) || key == index)\r\n                        continue;\r\n\r\n                    if (jsonC['eventList'][key]['name'] === input.val()) {\r\n                        errSpan.html(ERR_MSG_DUPLICATE_VAL);\r\n                        input.parent().addClass('is-invalid').addClass('wrong-val');\r\n                        console.log('こっち');\r\n                        toggleBtn(false);\r\n                        isValid = false;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (isValid) {\r\n                    input.parent().removeClass('is-invalid').removeClass('wrong-val');\r\n                    toggleBtn(true);\r\n                    jsonC['eventList'][index]['name'] = input.val();//todo ここでさ、index使ってるじゃん。てことはさ、配列も並び替えしなきゃいけないんだよ、きっと。\r\n                    masterJson[dataOrder]['data']['0'] = JSON.stringify(jsonC);\r\n                }\r\n            }\r\n        });\r\n\r\n        console.log(masterJson);//todo アニメーションできたらなあ。\r\n    });\r\n\r\n    //イベント名入力イベント\r\n    var errSpan = block.find('.event_name .mdl-textfield__error');\r\n    block.find('.input_eve').keyup(function (e) {\r\n        //todo 不正な値であっても、masterJsonに書き込んでいることに注意してください。\r\n        var isValid = isValidAboutNullAndDelimiter($(e.target), errSpan);\r\n        if(!isValid){\r\n            toggleBtn(false);\r\n            return;\r\n        }\r\n\r\n        var currentDataOrder = $(e.target).parents('.card-wrapper-i').attr('data-order');\r\n        var index = $(e.target).parents('tr').index();\r\n        console.log('index:', index);\r\n        var jsonC = JSON.parse(masterJson[currentDataOrder]['data']['0']);\r\n        for(var key in jsonC['eventList']) {\r\n            if(!jsonC['eventList'].hasOwnProperty(key) || key == index)\r\n                continue;\r\n\r\n            if (jsonC['eventList'][key]['name'] === $(e.target).val()) {\r\n                errSpan.html(ERR_MSG_DUPLICATE_VAL);\r\n                $(e.target).parent().addClass('is-invalid').addClass('wrong-val');\r\n                console.log('こっち');\r\n                toggleBtn(false);\r\n                return;\r\n            }\r\n        }\r\n\r\n        $(e.target).parent().removeClass('is-invalid').removeClass('wrong-val');\r\n        toggleBtn(true);\r\n        jsonC['eventList'][index]['name'] = $(e.target).val();\r\n        masterJson[currentDataOrder]['data']['0'] = JSON.stringify(jsonC);\r\n    });\r\n\r\n    block.insertBefore($(doc).find('.eve-add'));\r\n\r\n    return block;\r\n}\r\n\r\nfunction onHoverForPopover(e) {\r\n    if(!$('.popover').length)\r\n        $(e.target).popover('show');\r\n}\r\n\r\n\r\nfunction format0to00(value) {\r\n    return value.toString().length === 1 ?\r\n        '0'+value : value;\r\n}\r\n\r\nfunction setDataOrderToEveList(block, hourOfDay, min) {\r\n    //date-orderを付加\r\n    var time = moment();\r\n    time.hour(hourOfDay);\r\n    time.minute(min);\r\n    $(block).attr('data-order', time.format('Hmm'));\r\n}\r\n\r\nfunction setDatePickerLisntener(ele) {\r\n    return ele.bootstrapMaterialDatePicker({\r\n        date: false,\r\n        shortTime: false,\r\n        format: 'H:mm'\r\n    }).on('open', function (event) {\r\n        isModalOpen = true;\r\n    }).on('close', function (event) {\r\n        isModalOpen = false;\r\n    });\r\n}\r\n\r\nfunction createOneRangeRow(doc, count, value, masterJson) {\r\n\r\n    var blocks = [];\r\n    blocks[0] = createHtmlAs1Eve();\r\n    setDataOrderToRangeList($(blocks[0]), count);\r\n    $(blocks[0]).find('.remove-btn').hide();\r\n    $(blocks[0]).addClass('range-pre');\r\n    blocks[1] = craeteHtmlAs1Row();\r\n    setDataOrderToRangeList($(blocks[1]), count);\r\n    blocks[2] = createHtmlAs1Eve();\r\n\r\n    //ラベルをセット\r\n    var label0 = $(blocks[0]).find('.time_input').parent().find('label');\r\n    setLabelOfOffset(label0, value['start']['offset']);\r\n    var level2 = $(blocks[2]).find('.time_input').parent().find('label');\r\n    setLabelOfOffset(level2, value['end']['offset']);\r\n\r\n    setDataOrderToRangeList($(blocks[2]), count);\r\n    $(blocks[2]).find('.remove-btn').hide();\r\n    $(blocks[2]).addClass('range-post');\r\n    var startInputs = $(blocks[0]).find(\".mdl-textfield__input\");\r\n    setEveInputValues(startInputs, value[\"start\"]);\r\n    var endInputs = $(blocks[2]).find(\".mdl-textfield__input\");\r\n    setEveInputValues(endInputs, value[\"end\"]);\r\n\r\n    //●をカラーリング\r\n    $(blocks[0]).find('.circle').css('background-color', colors[value[\"colorNum\"]]).attr('colorNum', value[\"colorNum\"]);\r\n    $(blocks[2]).find('.circle').css('background-color', colors[value[\"colorNum\"]]).attr('colorNum', value[\"colorNum\"]);\r\n    $(blocks[1]).find('.icon_down').css('color', colors[value[\"colorNum\"]]).attr('colorNum', value[\"colorNum\"]);\r\n\r\n    //リスナをセット\r\n    setRangeDatePicker($(blocks[0]), masterJson, value['start']['offset']);\r\n    setRangeDatePicker($(blocks[2]), masterJson, value['end']['offset']);\r\n\r\n    //削除ボタンイベント\r\n    $(blocks[1]).find('.remove-btn').on('click', function (ev) {\r\n        var tr = $(this).closest('tr');\r\n        // var index = tr.index() - tr.parents('tbody').find('.eve-add').index()-1;\r\n        var dataOrder = $(this).closest(\".card-wrapper-i\").attr('data-order');\r\n        var dataNum = getRangeIndex($(this));\r\n        var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n        jsonC[\"rangeList\"].splice(dataNum, 1);\r\n        masterJson[dataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n\r\n        tr.prev().remove();\r\n        tr.next().remove();\r\n        $(this).tooltip('hide');\r\n        tr.remove();\r\n\r\n        checkRangeDuplicateItem($(doc), jsonC);\r\n    });\r\n\r\n    //region 禁則文字まわり\r\n    var startInput = $(blocks[0]).find('.input_eve');\r\n    var endInput = $(blocks[2]).find('.input_eve');\r\n    var errSpanStart = $(blocks[0]).find('.event_name .mdl-textfield__error');\r\n    var errSpanEnd = $(blocks[2]).find('.event_name .mdl-textfield__error');\r\n\r\n    startInput.keyup(function (e) {\r\n\r\n        var isValid = isValidAboutNullAndDelimiter($(e.target), errSpanStart);\r\n        if(!isValid){\r\n            toggleBtn(false);\r\n            return;\r\n        }\r\n\r\n        var currentDataOrder = $(e.target).parents('.card-wrapper-i').attr('data-order');\r\n        var index = getRangeIndex($(e.target));\r\n        var jsonC = JSON.parse(masterJson[currentDataOrder]['data']['0']);\r\n\r\n        if($(e.target).val() === jsonC['rangeList'][index]['end']['name']){\r\n            showEachErrSpan(startInput, endInput, errSpanStart, errSpanEnd, ERR_MSG_EACH_VAL_SAME);\r\n            toggleBtn(false);\r\n            return;\r\n        }\r\n\r\n        console.log($(e.target).val(), jsonC['rangeList'][index]['end']['name']);\r\n\r\n        for(var key in jsonC['rangeList']) {\r\n            if(!jsonC['rangeList'].hasOwnProperty(key))\r\n                continue;\r\n\r\n            if(key == index)\r\n                continue;\r\n\r\n            if (jsonC['rangeList'][key]['start']['name'] === $(e.target).val()\r\n                && jsonC['rangeList'][key]['end']['name'] === endInput.val()) {\r\n\r\n                showEachErrSpan(startInput, endInput, errSpanStart, errSpanEnd, ERR_MSG_DUPLICATE_VAL);\r\n                isValid = false;\r\n                console.log('こっち');\r\n                toggleBtn(false);\r\n                return;\r\n            }\r\n        }\r\n\r\n        $(e.target).parent().removeClass('is-invalid').removeClass('wrong-val');\r\n        endInput.parent().removeClass('is-invalid').removeClass('wrong-val');\r\n        toggleBtn(true);\r\n        console.log('うむむ');\r\n        jsonC['eventList'][index]['name'] = $(e.target).val();\r\n        masterJson[currentDataOrder]['data']['0'] = JSON.stringify(jsonC);\r\n    });\r\n\r\n\r\n    endInput.keyup(function (e) {\r\n\r\n        var isValid = isValidAboutNullAndDelimiter($(e.target), errSpanEnd);\r\n        if(!isValid){\r\n            toggleBtn(false);\r\n            return;\r\n        }\r\n\r\n        var currentDataOrder = $(e.target).parents('.card-wrapper-i').attr('data-order');\r\n        var index = getRangeIndex($(e.target));\r\n        var jsonC = JSON.parse(masterJson[currentDataOrder]['data']['0']);\r\n\r\n        if($(e.target).val() === jsonC['rangeList'][index]['start']['name']){\r\n            showEachErrSpan(startInput, endInput, errSpanStart, errSpanEnd, ERR_MSG_EACH_VAL_SAME);\r\n            toggleBtn(false);\r\n            return;\r\n        }\r\n\r\n        console.log($(e.target).val(), jsonC['rangeList'][index]['start']['name']);\r\n\r\n        for(var key in jsonC['rangeList']) {\r\n            if(!jsonC['rangeList'].hasOwnProperty(key))\r\n                continue;\r\n\r\n            if(key == index)\r\n                continue;\r\n\r\n            if (jsonC['rangeList'][key]['start']['name'] === startInput.val()\r\n                && jsonC['rangeList'][key]['end']['name'] === $(e.target).val()) {\r\n\r\n                showEachErrSpan(startInput, endInput, errSpanStart, errSpanEnd, ERR_MSG_DUPLICATE_VAL);\r\n                console.log('こっち');\r\n                toggleBtn(false);\r\n                return;\r\n            }\r\n        }\r\n\r\n        $(e.target).parent().removeClass('is-invalid').removeClass('wrong-val');\r\n        startInput.parent().removeClass('is-invalid').removeClass('wrong-val');\r\n        toggleBtn(true);\r\n        console.log('うむふぁｓｆだｆｄ');\r\n    });\r\n    //endregion\r\n\r\n    //色指定のポップオーバー\r\n    for(var i=0; i<blocks.length; i++){\r\n        // var element = blocks[i].cloneNode(true);\r\n        //おわかりかと思うが、このロジックが正常に動作するためには、{#range-add}を先にdomに追加しないといけない\r\n        $(blocks[i]).find('.circle,.icon_down')\r\n            .popover(TIME_POPOVER_CONFIG)\r\n            .hover(function (e) {\r\n                onHoverForPopover(e);\r\n            })\r\n            .on('shown.bs.popover', function (e) {\r\n                console.log('onShown');\r\n                // var dataOrder = $(this).parents(\".card-wrapper-i\").attr('data-order');\r\n                // var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n                var tr = $(this).parents('tr');\r\n                var index = tr.index();\r\n                var colorNum = $(e.target).attr('colorNum');\r\n\r\n                var popoverId = $(e.target).attr('aria-describedby');\r\n                var popover = $('#'+popoverId);\r\n                // var rgb = $(this).parents('tr').find('.circle').css('color').substring(4);\r\n                // rgb = rgb.substring(0, rgb.length-1);\r\n                // var colorNum = colors.indexOf(rgbToHex(rgb[0], rgb[1], rgb[2]));\r\n                // console.log(rgbToHex(rgb[0], rgb[1], rgb[2]));\r\n                popover.find('.fa-circle')\r\n                    .on('click', function (e2) {\r\n                        console.log('cicle clicked');\r\n\r\n                        var currentDataOrder = $(e.target).parents('tr').attr('data-order');\r\n                        var index = $(e2.target).parents('.fa-layers').index();\r\n                        console.log(index);\r\n                        var newColor = colors[index];\r\n                        $(e.target).css('background-color', newColor);\r\n                        var trs = $(e.target)\r\n                            .parents('tbody')\r\n                            .find('tr[data-order=\"'+ currentDataOrder +'\"]');\r\n                        trs.find('.circle').css('background-color', newColor);\r\n                        trs.find('.icon_down').css('color', newColor);\r\n\r\n                        $(e2.target).parents('.circle-popover').find('.fa-check:visible').hide();\r\n                        $(e2.target).parents('.fa-layers').find('.fa-check').show();\r\n\r\n                        var jsonC = JSON.parse(masterJson[currentDataOrder]['data'][\"0\"]);\r\n                        jsonC[\"eventList\"][currentDataOrder]['colorNum'] = index.toString();\r\n                        masterJson[currentDataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n                    });\r\n                var className = '.circle'+ (parseInt(colorNum)+1);\r\n                popover.find(className).parents('.fa-layers').find('.fa-check').show();\r\n                // .eq(jsonC[\"rangeList\"][index]['colorNum'])\r\n                // .find('.fa-check').show();\r\n\r\n                $(window).hover(function (e2) {\r\n                    var dataOrder = $(e.target).parents(\".card-wrapper-i\").attr('data-order');\r\n                    //混迷を極めるhover判定\r\n                    if($(e2.target).parents('.popover').length || $(e2.target).hasClass('popover')) {\r\n                        return false;\r\n                    } else if(($(e2.target).hasClass('card') || $(e2.target).parents('tr').index() === index || $(e2.target).parents('tr').index() === index+1)\r\n                        &&\r\n                        ($(e2.target).parents('.card-wrapper-i[data-order='+ dataOrder +']').length || $(e2.target).attr('data-order') == dataOrder)) {\r\n                        return false\r\n                    }\r\n                    console.log('hideやね', e2.target);\r\n                    $(e.target).popover('hide');\r\n                });\r\n\r\n            }).on('hidden.bs.popover', function (e) {\r\n                console.log('onHidden');\r\n                $(window).off('mouseenter mouseleave');\r\n        });\r\n\r\n        initAllTooltips();\r\n        $(blocks[i]).insertBefore($(doc).find('.range-add'));\r\n    }\r\n}\r\n\r\nfunction checkRangeDuplicateItem(doc, jsonC) {\r\n    doc.find('.range-pre').each(function (i, elem) {\r\n        var dataOrderRow = $(elem).attr('data-order');\r\n        var startInput = $(elem).find('.input_eve');\r\n        var endInput = $(doc).find('.range-post[data-order='+ dataOrderRow +']').find('.input_eve');\r\n        var isValid = true;\r\n\r\n        for(var key in jsonC['rangeList']) {\r\n            if(!jsonC['rangeList'].hasOwnProperty(key) || key == i) {\r\n                console.log(key, i);\r\n                continue;\r\n            }\r\n\r\n            if (jsonC['rangeList'][key]['start']['name'] === startInput.val() && jsonC['rangeList'][key]['end']['name'] === endInput.val()) {\r\n                showEachErrSpan(startInput, endInput, startInput.parent().find('.mdl-textfield__error'), endInput.parent().find('.mdl-textfield__error'), ERR_MSG_DUPLICATE_VAL);\r\n                console.log('invalid value');\r\n                toggleBtn(false);\r\n                isValid = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (isValid) {\r\n            startInput.parent().removeClass('is-invalid').removeClass('wrong-val');\r\n            endInput.parent().removeClass('is-invalid').removeClass('wrong-val');\r\n            toggleBtn(true);\r\n        }\r\n    });\r\n}\r\n\r\nfunction getRangeIndex(target) {\r\n    var tr = target.parents('tr');\r\n    var index = tr.index() - tr.parents('tbody').find('.eve-add').index()-1;\r\n    return Math.floor(index/3);\r\n}\r\n\r\nfunction setLabelOfOffset(label, offset) {\r\n    switch (offset){\r\n        case -1:\r\n            label.html('前日');\r\n            break;\r\n        case 0:\r\n            label.html('');\r\n            break;\r\n        case 1:\r\n            label.html('翌日');\r\n            break;\r\n    }\r\n}\r\n\r\nfunction setDataOrderToRangeList(block, rangeNum) {\r\n    block.attr('data-order', rangeNum + 10000);\r\n}\r\n\r\nfunction showEachErrSpan(startInput, endInput, errSpanStart, errSpanEnd, errMsg) {\r\n    errSpanStart.html(errMsg);\r\n    startInput.parent().addClass('is-invalid').addClass('wrong-val');\r\n    errSpanEnd.html(errMsg);\r\n    endInput.parent().addClass('is-invalid').addClass('wrong-val');\r\n}\r\n\r\nfunction craeteHtmlAs1Row() {\r\n    return $(\r\n        '<tr class=\"angle-down\">' +\r\n            '<td colspan=\"3\">' +\r\n                '<i class=\"fas fa-angle-double-down icon_down\"></i>' +\r\n            '</td>' +\r\n            '<td colspan=\"1\">' +\r\n                '<button class=\"mdl-button mdl-js-button mdl-button--icon mdl-pre-upgrade remove-btn\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"項目を追加\">' +\r\n                    '<i class=\"fas fa-times\"></i>' +\r\n                '</button>' +\r\n            '</td>' +\r\n        '</tr>')[0];\r\n}\r\n\r\nfunction createHtmlAs2() {\r\n    return $(\r\n        '<div class=\"tag_wrapper\" data-tag-order=\"0\">'+\r\n            '<span class=\"mdl-chip mdl-chip--deletable\">' +\r\n                '<span class=\"mdl-chip__text\"></span>' +\r\n                    '<i class=\"fas fa-check fa-2x mdl-chip__action\"></i>' +\r\n                '<button type=\"button\" class=\"mdl-chip__action\"><i class=\"material-icons\">cancel</i></button>' +\r\n            '</span>'+\r\n        '</div>');\r\n}\r\n\r\nfunction setRangeDatePicker(block, masterJson, offset) {\r\n    var input = block.find('input').eq(0);\r\n    setDatePickerLisntener(input)\r\n        .on('change', function (event, date) {\r\n            var tr = $(event.target).parents('tr');\r\n            var rowOrder = tr.attr('data-order');\r\n            var index = $(event.target).parents('tr').index() - $(event.target).parents('tbody').find('.eve-add').index()-1;\r\n            var dataOrder = $(event.target).closest(\".card-wrapper-i\").attr('data-order');\r\n            var dataNum = Math.floor(index/3);\r\n            console.log(dataNum, index%3);\r\n            var startOrEnd;\r\n            var otherEdge;\r\n            var otherClass;\r\n            switch (index%3) {\r\n                case 0:\r\n                    startOrEnd = 'start';\r\n                    otherEdge = 'end';\r\n                    otherClass = 'range-post';\r\n                    break;\r\n                case 2:\r\n                    startOrEnd = 'end';\r\n                    otherEdge = 'start';\r\n                    otherClass = 'range-pre';\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n\r\n            var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n            var time = moment($(event.target).val(), 'H:mm');\r\n            var n = index%3;\r\n            if(n === 2)\r\n                n = 1;\r\n\r\n            var offset = $('.dtp').eq(jsonC[\"eventList\"].length + dataNum*2 +n)\r\n                .find('.date-picker-radios input:checked')\r\n                .parent().index() -1;\r\n\r\n            time.add('d', offset);\r\n\r\n            var timeOther = moment({\r\n                hour: jsonC[\"rangeList\"][dataNum][otherEdge][\"cal\"][\"hourOfDay\"],\r\n                minute: jsonC[\"rangeList\"][dataNum][otherEdge][\"cal\"][\"minute\"]\r\n            });\r\n            timeOther.add('d', jsonC[\"rangeList\"][dataNum][otherEdge][\"cal\"][\"offset\"]);\r\n\r\n            var max = moment.max(time, timeOther);\r\n            var timeInput = tr.find('.time').find('.mdl-textfield');\r\n            var timeOtherInput = tr.parents('table').find('.'+ otherClass + '[data-order='+ rowOrder +'] .time .mdl-textfield');\r\n            if ((startOrEnd === 'start' && max === time) || (startOrEnd === 'end' && max === timeOther)) {\r\n                timeInput.addClass('is-invalid').addClass('wrong-val').removeClass('is-focused')//.removeClass('is-focused')しないとフォーカスが永遠に外れない\r\n                    .tooltip({\r\n                        title: '開始時刻が終了時刻を超えないようにしてください'\r\n                    });\r\n                timeOtherInput.addClass('is-invalid').addClass('wrong-val').removeClass('is-focused')\r\n                    .tooltip({\r\n                        title: '開始時刻が終了時刻を超えないようにしてください'\r\n                    });\r\n                toggleBtn(false);\r\n            } else {\r\n                timeInput.removeClass('is-invalid').removeClass('wrong-val').removeClass('is-focused').tooltip('dispose');\r\n                timeOtherInput.removeClass('is-invalid').removeClass('wrong-val').removeClass('is-focused').tooltip('dispose');\r\n                toggleBtn(true);\r\n            }\r\n\r\n            var label = $(event.target).parent().find('label');\r\n            switch (offset){\r\n                case -1:\r\n                    label.html('前日');\r\n                    break;\r\n                case 0:\r\n                    label.html('');\r\n                    break;\r\n                case 1:\r\n                    label.html('翌日');\r\n                    break;\r\n            }\r\n\r\n            jsonC[\"rangeList\"][dataNum][startOrEnd][\"cal\"][\"hourOfDay\"] = time.hour();\r\n            jsonC[\"rangeList\"][dataNum][startOrEnd][\"cal\"][\"minute\"] = time.minute();\r\n            jsonC[\"rangeList\"][dataNum][startOrEnd][\"cal\"][\"offset\"] = offset;\r\n            masterJson[dataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n            console.log(masterJson);\r\n        });\r\n\r\n    var datePickers = $('.dtp-actual-meridien');\r\n\r\n    // datePickerを整備\r\n    var radios = createHtmlRadio();\r\n    radios.find('input').eq(offset+1).attr('checked', 'checked');\r\n    var row = datePickers.eq(datePickers.length-1);\r\n    radios.insertBefore(row);\r\n    setElementAsMdl(radios);\r\n    row.hide();\r\n}\r\n\r\nvar radioCount = 0;\r\nfunction createHtmlRadio() {\r\n    radioCount++;\r\n    var id0 = radioCount + '-option-1';\r\n    var id1 = radioCount + '-option-2';\r\n    var id2 = radioCount + '-option-3';\r\n\r\n    return $(\r\n        '<form class=\"date-picker-radios\">'+\r\n            '<tr>'+\r\n                '<td>'+\r\n                    '<label class=\"mdl-radio mdl-js-radio mdl-js-ripple-effect mdl-pre-upgrade\" for=\"'+ id0 +'\">'+\r\n                        '<input type=\"radio\" id=\"'+ id0 +'\" class=\"mdl-radio__button mdl-pre-upgrade\" name=\"options\" value=\"1\">'+\r\n                        '<span class=\"mdl-radio__label mdl-pre-upgrade\">前日</span>'+\r\n                    '</label>'+\r\n                '</td>'+\r\n                '<td>'+\r\n                    '<label class=\"mdl-radio mdl-js-radio mdl-js-ripple-effect mdl-pre-upgrade\" for=\"'+ id1 +'\">'+\r\n                        '<input type=\"radio\" id=\"'+ id1 +'\" class=\"mdl-radio__button mdl-pre-upgrade\" name=\"options\" value=\"1\">'+\r\n                        '<span class=\"mdl-radio__label mdl-pre-upgrade\">当日</span>'+\r\n                    '</label>'+\r\n                '</td>'+\r\n                '<td>'+\r\n                    '<label class=\"mdl-radio mdl-js-radio mdl-js-ripple-effect mdl-pre-upgrade\" for=\"'+ id2 +'\">'+\r\n                        '<input type=\"radio\" id=\"'+ id2 +'\" class=\"mdl-radio__button mdl-pre-upgrade\" name=\"options\" value=\"1\">'+\r\n                        '<span class=\"mdl-radio__label mdl-pre-upgrade\">翌日</span>'+\r\n                    '</label>'+\r\n                '</td>'+\r\n            '</tr>'+\r\n        '</form>'\r\n    );\r\n}\r\n\r\nfunction  getCommentAsNullable(childSnap) {\r\n    if (!childSnap[\"data\"]){\r\n        return null;\r\n    }\r\n    return childSnap[\"data\"];\r\n}\r\n\r\n//todo ここって'comment'じゃなかったっけ？？\r\nfunction operateAs4(doc, childSnap, masterJson) {\r\n    var clone = createHtmlAs4();\r\n    // var clone = document.getElementById(\"comment_dummy\").cloneNode(true);\r\n    var summery = getCommentAsNullable(childSnap);\r\n    var input = clone.find(\".mdl-textfield__input\");\r\n    var errSpan = clone.find('.mdl-textfield__error');\r\n\r\n    if(summery)\r\n        clone.find(\".mdl-textfield__input\").attr(\"value\", summery);\r\n\r\n    input.keyup(function (e) {\r\n        if (input.val().indexOf(DELIMITER) !== -1){\r\n            errSpan.html(ERR_MSG_CONTAIN_BAD_CHAR.join(DELIMITER));\r\n            input.parent().addClass('is-invalid').addClass('wrong-val');\r\n            toggleBtn(false);\r\n\r\n        } else {\r\n            $(e.target).parent().removeClass('is-invalid').removeClass('wrong-val');\r\n            var currentDataOrder = $(e.target).parents('.card-wrapper-i').attr('data-order');\r\n            masterJson[currentDataOrder]['data'] = $(e.target).val();\r\n            console.log(masterJson);\r\n            toggleBtn(true);\r\n        }\r\n    });\r\n\r\n    $(doc).append(clone);\r\n}\r\n\r\nfunction createHtmlAs4() {\r\n    return $(\r\n        '<div>'+\r\n            '<div id=\"comment_dummy\">'+\r\n                '<form action=\"#\" class=\"comment_form\">' +\r\n                    '<div class=\"mdl-textfield mdl-js-textfield comment mdl-pre-upgrade\">' +\r\n                        '<textarea class=\"mdl-textfield__input comment_ta mdl-pre-upgrade\" type=\"text\" rows= \"3\" id=\"comment\" ></textarea>' +\r\n                        '<label class=\"mdl-textfield__label mdl-pre-upgrade\" for=\"comment\">Text...</label>' +\r\n                        '<span class=\"mdl-textfield__error mdl-pre-upgrade\"></span>'+\r\n                    '</div>' +\r\n                '</form>' +\r\n            '</div>'+\r\n        '</div>');\r\n}\r\n\r\nfunction initAllTooltips() {\r\n    $('[data-toggle=\"tooltip\"]').tooltip({\r\n        offset: '0, 8px'\r\n    });\r\n}\r\n\r\nfunction createAddTagBtn() {\r\n    return $(\r\n        '<button class=\"mdl-button mdl-js-button mdl-button--icon tag-add-btn mdl-pre-upgrade\" data-tag-order=\"1000\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"項目を追加\">' +\r\n            '<i class=\"material-icons\">add_circle</i>' +\r\n        '</button>');\r\n}\r\n\r\nfunction setTagUi(clone, splited) {\r\n    $(clone).find(\".mdl-chip__text\").html(splited[0]);\r\n\r\n    if (splited[2] === \"false\") {\r\n        $(clone).find(\".fa-check\").hide();\r\n    }\r\n    $(clone).find(\".mdl-chip\").css(\"background-color\", highlightColors[parseInt(splited[1])]);\r\n}\r\n\r\nfunction showModal() {\r\n    var modal = $('#exampleModal').modal();\r\n}\r\n\r\nfunction onClickAddParamsLiBtn(splited, e, e2) {\r\n    var currentDataOrder = $(e.target).parents('.card-wrapper-i').attr('data-order');\r\n    masterJson[currentDataOrder]['data'].push(splited.join(DELIMITER));\r\n    var ul = $(e.target).parents('.card').find('.mdl-list');\r\n    createParamsLi(splited, currentDataOrder, ul.length)\r\n        .appendTo(ul);\r\n    setElementAsMdl(ul);\r\n    $(e.target).popover('hide');\r\n}\r\n\r\nfunction createAddLiBtn() {\r\n    return $(\r\n        '<div class=\"add-li-btn\">'+\r\n            '<button class=\"mdl-button mdl-js-button mdl-button--icon add-li-btn mdl-pre-upgrade\" data-toggle=\"popover\">' +\r\n                '<i class=\"material-icons\">add_circle</i>' +\r\n            '</button>'+\r\n        '</div>'\r\n    );\r\n}\r\n\r\nfunction onKeyUpParamsTitle(masterJson, input, errSpan) {\r\n    var index = input.closest(\"li\").index();\r\n    var currentDataOrder = input.parents('.card-wrapper-i').attr('data-order');\r\n    var isValid = isValidAboutNullAndDelimiter(input, errSpan);\r\n    if(!isValid){\r\n        toggleBtn(false);\r\n        return;\r\n    }\r\n\r\n    for(var value in masterJson[currentDataOrder]['data']) {\r\n        if(masterJson[currentDataOrder]['data'].hasOwnProperty(value)) {\r\n            var val = masterJson[currentDataOrder]['data'][value].split(DELIMITER)[1];\r\n            if(input.val() === val){\r\n                errSpan.html(ERR_MSG_DUPLICATE_VAL);\r\n                input.parent().addClass('is-invalid').addClass('wrong-val');\r\n                toggleBtn(false);\r\n                console.log('こっち');\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    input.parent().removeClass('is-invalid').removeClass('wrong-val');\r\n    toggleBtn(true);\r\n    var splited = masterJson[currentDataOrder][\"data\"][index].split(DELIMITER);\r\n    splited[1] = input.val();\r\n    masterJson[currentDataOrder][\"data\"][index] = splited.join(DELIMITER);\r\n    console.log(masterJson);\r\n}\r\n\r\n////////////////////region 新規イベントデータ作成\r\nfunction createNewTimeEveData() {\r\n    var today = moment();\r\n\r\n    var value  = {};\r\n    value['colorNum'] = 0;\r\n    value['offset'] = 0;\r\n    value['name'] = '新しいイベント';\r\n\r\n    value['cal'] = {};\r\n    value['cal']['year'] = today.year();\r\n    value['cal']['month'] = today.month();\r\n    value['cal']['dayOfMonth'] = today.date();\r\n    value['cal']['hourOfDay'] = today.hour();\r\n    value['cal']['minute'] = today.minute();\r\n    value['cal']['second'] = 0;\r\n\r\n    return value;\r\n}\r\n\r\nfunction createNewRangeData() {\r\n    var today = moment();\r\n\r\n    var value  = {};\r\n    value['colorNum'] = 0;\r\n    value['start'] = {};\r\n    value['start']['colorNum'] = 0;\r\n    value['start']['name'] = '開始';\r\n    value['start']['offset'] = 0;\r\n\r\n    value['start']['cal'] = {};\r\n    value['start']['cal']['year'] = today.year();\r\n    value['start']['cal']['month'] = today.month();\r\n    value['start']['cal']['dayOfMonth'] = today.date();\r\n    value['start']['cal']['hourOfDay'] = 7;\r\n    value['start']['cal']['minute'] = 0;\r\n    value['start']['cal']['second'] = 0;\r\n\r\n    value['end'] = {};\r\n    value['end']['colorNum'] = 0;\r\n    value['end']['name'] = '終了';\r\n    value['end']['offset'] = 0;\r\n\r\n    value['end']['cal'] = {};\r\n    value['end']['cal']['year'] = today.year();\r\n    value['end']['cal']['month'] = today.month();\r\n    value['end']['cal']['dayOfMonth'] = today.date();\r\n    value['end']['cal']['hourOfDay'] = 22;\r\n    value['end']['cal']['minute'] = 0;\r\n    value['end']['cal']['second'] = 0;\r\n\r\n    return value;\r\n}\r\n\r\nfunction createNewData(dataType) {\r\n    var data = {\r\n        dataType: dataType,\r\n        day: 0,\r\n        mon: 0,\r\n        year: 0\r\n    };\r\n\r\n    if (dataType === 2 || dataType === 3 || dataType === 4) {\r\n        data.dataName = '新しい項目';\r\n    }\r\n\r\n    if (dataType === 2 || dataType === 3){\r\n        data.data = [];\r\n    } else if (dataType === 1) {\r\n        var jsonStr = {\r\n            eventList: [],\r\n            rangeList: []\r\n        };\r\n        data.data = {};\r\n        data['data']['0'] = JSON.stringify(jsonStr);\r\n    } else if (dataType === 0) {\r\n        data.data = {};\r\n        data['data']['0'] = \"勤務日\"+ DELIMITER +\"2\";\r\n    }\r\n\r\n    return data;\r\n}\r\n//endregion\r\n\r\n/**\r\n * variable 'hm' is key of one EventData to sort, but it may duplicate.\r\n * so variable 'map[hm]' is typeof array. it corresponds to sort.\r\n */\r\nfunction sortByTime(eventList) {\r\n    var map = {};\r\n\r\n    eventList.forEach(function (value) {\r\n        var hour = value.cal.hourOfDay;\r\n        var min = value.cal.minute;\r\n        var hm = hour.toString() + format0to00(min);\r\n        if(!map[hm])\r\n            map[hm] = [];\r\n\r\n        map[hm].push(value);\r\n    });\r\n\r\n    var sortedKeys = Object.keys(map).sort(function (a, b) {\r\n        return a-b;\r\n    });\r\n    console.log(map, sortedKeys);\r\n    var newEveList = [];\r\n    for(var key in sortedKeys) {\r\n        if(sortedKeys.hasOwnProperty(key)){\r\n            map[sortedKeys[key]].forEach(function (value) {\r\n                newEveList.push(value);\r\n            });\r\n        }\r\n    }\r\n    return newEveList;\r\n}\r\n\r\nfunction toggleBtn(isShow) {\r\n    if (isShow && $('.wrong-val').length === 0) {\r\n        $('#save').fadeIn();\r\n    } else {\r\n        $('#save').fadeOut();\r\n        console.log($('.wrong-val'));\r\n    }\r\n}\r\n\r\nfunction onClickAddRowBtn(ele, masterJson, doc) {\r\n    console.log('addRowBtn click');\r\n    var value = createNewTimeEveData();\r\n    var newRow = createOneEveRow(doc, value, masterJson, saveBtn);\r\n    var dataOrder = ele.parents(\".card-wrapper-i\").attr('data-order');\r\n    var jsonC = JSON.parse(masterJson[dataOrder]['data'][\"0\"]);\r\n    jsonC['eventList'].push(value);//todo ん？push??ここは時刻でsortすべきでは？ん?sortするってことは、迂闊にindex()とかできないな・・・ mixitUpでソートした後、いい感じにすることだ。\r\n    jsonC['eventList'] = sortByTime(jsonC['eventList']);\r\n\r\n    masterJson[dataOrder]['data'][\"0\"] = JSON.stringify(jsonC);\r\n\r\n    console.log(JSON.parse(masterJson[dataOrder]['data'][\"0\"]));\r\n\r\n    sortByMixitUp($(doc));\r\n\r\n    initAllTooltips();\r\n\r\n    $(newRow).find(\".mdl-textfield__input\").keyup();\r\n}\r\n\r\nfunction sortByMixitUp(doc) {\r\n    mixitup(doc.find('tbody')[0], {\r\n        load: {\r\n            sort: 'order:asc'\r\n        },\r\n        behavior: {\r\n            liveSort: true\r\n        },\r\n        animation: {\r\n            duration: 250,\r\n            nudge: true,\r\n            reverseOut: false,\r\n            effects: \"fade translateZ(-100px)\"\r\n        },\r\n        selectors: {\r\n            target: 'tbody tr',\r\n            control: '.mixitup-control'//@see https://goo.gl/QpW5BR\r\n        }\r\n    }).sort(\"order:asc\");\r\n\r\n    setElementAsMdl(doc);\r\n}\r\n\r\nfunction initAddLiBtn() {\r\n    var addLiBtn = createAddLiBtn();\r\n    addLiBtn.find('button')\r\n        .popover({\r\n            trigger: 'manual',\r\n            placement: 'bottom',\r\n            content:'<div class=\"param-add-popover\">'+\r\n                        '<button type=\"button\" class=\"btn btn-secondary add-checkbox\">チェックボックス</button>'+\r\n                        '<button type=\"button\" class=\"btn btn-secondary add-slider\">スライダー</button>'+\r\n                    '</div>',\r\n            html: true,\r\n            container: 'body',\r\n            offset: '0 8px'\r\n        })\r\n        .hover(function (e) {\r\n            onHoverForPopover(e);\r\n        })\r\n        .on('shown.bs.popover', function (e) {\r\n            console.log(e);\r\n            var popoverId = $(this).attr('aria-describedby');\r\n            var poppover = $('#'+popoverId);\r\n            poppover.find('.add-slider')\r\n                .on('click', function (e2) {\r\n                    var splited = ['1', '新しい項目', '3', '5'];\r\n                    onClickAddParamsLiBtn(splited, e, e2);\r\n                });\r\n            poppover.find('.add-checkbox')\r\n                .on('click', function (e2) {\r\n                    var splited = ['0', '新しい項目', 'true'];\r\n                    onClickAddParamsLiBtn(splited, e, e2);\r\n                });\r\n            // var popoverId = $(this).attr('aria-describedby');\r\n            $(window).hover(function (e2) {\r\n                if($(e2.target).parents('.popover').length || $(e2.target).hasClass('popover')){\r\n                    return false;\r\n                } else if($(e2.target).parents('.add-li-btn').length || $(e2.target).hasClass('add-li-btn')) {\r\n                    return false\r\n                }\r\n                console.log('hideやね', e2.target);\r\n                $(e.target).popover('hide');\r\n            });\r\n        })\r\n        .on('hidden.bs.popover', function (e) {\r\n            console.log(e);\r\n            $(window).off('mouseenter mouseleave');\r\n        });\r\n    return addLiBtn;\r\n}\r\n\r\nfunction getDefaultTemplate() {\r\n    return [{\r\n        \"data\" : [ \"{\\\"eventList\\\":[{\\\"cal\\\":{\\\"year\\\":2017,\\\"month\\\":10,\\\"dayOfMonth\\\":26,\\\"hourOfDay\\\":8,\\\"minute\\\":0,\\\"second\\\":20},\\\"colorNum\\\":2,\\\"name\\\":\\\"出勤\\\",\\\"offset\\\":0},{\\\"cal\\\":{\\\"year\\\":2017,\\\"month\\\":10,\\\"dayOfMonth\\\":26,\\\"hourOfDay\\\":14,\\\"minute\\\":55,\\\"second\\\":20},\\\"colorNum\\\":0,\\\"name\\\":\\\"帰宅\\\",\\\"offset\\\":0}],\\\"rangeList\\\":[{\\\"colorNum\\\":0,\\\"end\\\":{\\\"cal\\\":{\\\"year\\\":2017,\\\"month\\\":10,\\\"dayOfMonth\\\":26,\\\"hourOfDay\\\":7,\\\"minute\\\":30,\\\"second\\\":20},\\\"colorNum\\\":0,\\\"name\\\":\\\"起床\\\",\\\"offset\\\":0},\\\"start\\\":{\\\"cal\\\":{\\\"year\\\":2017,\\\"month\\\":10,\\\"dayOfMonth\\\":26,\\\"hourOfDay\\\":22,\\\"minute\\\":0,\\\"second\\\":20},\\\"colorNum\\\":0,\\\"name\\\":\\\"就寝\\\",\\\"offset\\\":-1}}]}\" ],\r\n        \"dataType\" : 1,\r\n        \"day\" : 0,\r\n        \"mon\" : 0,\r\n        \"year\" : 0\r\n    }, {\r\n        \"data\" : [ \"震え9mVSv09mVSvtrue\", \"気分の低下9mVSv09mVSvtrue\", \"神経質9mVSv19mVSvfalse\", \"休憩をもらう9mVSv29mVSvtrue\", \"寝坊9mVSv09mVSvfalse\" ],\r\n        \"dataName\" : \"症状・セルフケア\",\r\n        \"dataType\" : 2,\r\n        \"day\" : 0,\r\n        \"mon\" : 0,\r\n        \"year\" : 0\r\n    }, {\r\n        \"data\" : [ \"資料作成9mVSv19mVSvtrue\", \"バックヤード9mVSv19mVSvtrue\", \"早出9mVSv29mVSvfalse\", \"残業9mVSv29mVSvtrue\", \"上司面談9mVSv39mVSvtrue\" ],\r\n        \"dataName\" : \"仕事内容\",\r\n        \"dataType\" : 2,\r\n        \"day\" : 0,\r\n        \"mon\" : 0,\r\n        \"year\" : 0\r\n    }, {\r\n        \"dataName\" : \"備考\",\r\n        \"dataType\" : 4,\r\n        \"day\" : 0,\r\n        \"mon\" : 0,\r\n        \"year\" : 0\r\n    }, {\r\n        \"data\" : [ \"09mVSv朝薬9mVSvfalse\", \"09mVSv夕薬9mVSvtrue\", \"09mVSv頓服9mVSvtrue\", \"09mVSv定時出勤9mVSvtrue\", \"19mVSv気分9mVSv39mVSv5\" ],\r\n        \"dataName\" : \"生活\",\r\n        \"dataType\" : 3,\r\n        \"day\" : 0,\r\n        \"mon\" : 0,\r\n        \"year\" : 0\r\n    }]\r\n}\r\n\r\n// function onClickLiRmBtn(e, masterJson) {\r\n//     e.preventDefault();\r\n//     console.log('clicked');\r\n//     var li = $(this).parents('li');\r\n//     var index = li.index();\r\n//     var currentDataOrder = $(e.target).parents('.card-wrapper-i').attr('data-order');\r\n//     masterJson[currentDataOrder][\"data\"].splice(index, 1);\r\n//     li.remove();//todo アニメーションつけようと思ったけどうまくいかない。\r\n//     console.log(masterJson);\r\n// }"]}